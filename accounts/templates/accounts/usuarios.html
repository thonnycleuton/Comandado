{% extends "base.html" %}
{% load static %}
{% block content %}
    <!-- PAGE CONTENT WRAPPER -->
    <div class="page-content-wrap">

        <div class="row">
            <div class="col-md-12">

                <!-- START DEFAULT DATATABLE -->
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Usuarios</h3>
                        <!-- SEARCH -->
                        <li class="xn-search">

                          <form method="post" action="/search/" class="autocomplete-me">
                              {% csrf_token %}
                            <input type="text" id="id_q" name="q">
                            <input type="submit" value="Search!">
                          </form>

                        </li>
                        <!-- END SEARCH -->
                        <ul class="panel-controls">
                            <li><a href="{% url 'contas:novo' %}" class="panel-collapse"><span class="fa fa-plus"></span></a></li>
                            <li><a href="#" class="panel-collapse"><span class="fa fa-angle-down"></span></a></li>
                            <li><a href="#" class="panel-refresh"><span class="fa fa-refresh"></span></a></li>
                            <li><a href="#" class="panel-remove"><span class="fa fa-times"></span></a></li>
                        </ul>
                    </div>
                    <div class="panel-body">
                        <table class="table datatable">
                            <thead>
                                <tr>
                                    <th width="40"></th>
                                    <th>Nome</th>
                                    <th>email</th>
                                    <th>Super User</th>
                                    <th>Ativo</th>
                                    <th>Apagar</th>
                                </tr>
                            </thead>
                            <tbody>
                            {% include 'accounts/includes/partial_profile_list.html' %}
                            </tbody>
                        </table>
                        <!-- warning -->
                        <div class="message-box message-box-warning animated fadeIn" id="message-box-warning">
                            <div class="mb-container">
                            </div>
                        </div>
                      </div>
                    </div>
                </div>
                <!-- END DEFAULT DATATABLE -->
            </div>
        </div>

    </div>
    <!-- PAGE CONTENT WRAPPER -->

{% endblock %}
{% block javascript %}
    <script type="text/javascript" src="{% static 'js/plugins/jquery/jquery.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/plugins/bootstrap/bootstrap.min.js' %}"></script>
    <script>
        $(document).ready(function(){
            $(".js-delete-book").click(function () {
              var btn = $(this);
              $.ajax({
                  url: btn.attr("data-url"),
                  type: 'get',
                  dataType: 'json',
                  beforeSend: function () {
                      $("#message-box-warning").modal("show");
                  },
                  success: function (data) {
                      $("#message-box-warning .mb-container").html(data.html_form);
                  }
              });

              $.ajax({
                  url: form.attr("action"),
                  data: form.serialize(),
                  type: form.attr("method"),
                  dataType: 'json',
                  success: function (data) {
                    if (data.form_is_valid) {
                      $("#message-box-warning tbody").html(data.html_book_list);
                      $("#message-box-warning").modal("hide");
                    }
                    else {
                      $("#modal-book .mb-container").html(data.html_form);
                    }
                  }
                });
            });
        });
    </script>
{% endblock %}