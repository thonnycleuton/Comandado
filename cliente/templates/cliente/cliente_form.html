{% extends "base.html" %}
{% load static %}
{% block content %}
    <!-- PAGE CONTENT WRAPPER -->
    <div class="page-content-wrap">

        <div class="row">
            <div class="col-md-12">

                <form id="jvalidate" class="form-horizontal" enctype="multipart/form-data" method="post" action="">
                    {% csrf_token %}
                    {% if form.errors %}
                        {% for field in form %}
                            {% for error in field.errors %}
                                <div class="alert alert-danger">
                                    <strong>{{ error|escape }}</strong>
                                </div>
                            {% endfor %}
                        {% endfor %}
                        {% for error in form.non_field_errors %}
                            <div class="alert alert-danger">
                                <strong>{{ error|escape }}</strong>
                            </div>
                        {% endfor %}
                    {% endif %}
                    <div class="panel panel-default tabs">
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="active"><a href="#tab-first" role="tab" data-toggle="tab">Dados Pessoais</a></li>
                            <li><a href="#tab-second" role="tab" data-toggle="tab">Endereco</a></li>
                            <li><a href="#tab-third" role="tab" data-toggle="tab">Contatos</a></li>
                        </ul>
                        <div class="panel-body tab-content">
                            <div class="tab-pane active" id="tab-first">
                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed dictum dolor sem, quis pharetra dui ultricies vel. Cras non pulvinar tellus, vel bibendum magna. Morbi tellus nulla, cursus non nisi sed, porttitor dignissim erat. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc facilisis commodo lectus. Vivamus vel tincidunt enim, non vulputate ipsum. Ut pellentesque consectetur arcu sit amet scelerisque. Fusce commodo leo eros, ut eleifend massa congue at.</p>

                        <div class="panel-body">
                            <!-- Primeira coluna do formulario -->
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">{{ form.nome.label_tag }}</label>
                                        <div class="col-md-9">
                                            <div class="input-group">
                                                <span class="input-group-addon"><span class="fa fa-pencil"></span></span>
                                                {{ form.nome }}
                                            </div>
                                            <span class="help-block">Nome do Cliente</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">{{ form.apelido.label_tag }}</label>
                                        <div class="col-md-9">
                                            <div class="input-group">
                                                <span class="input-group-addon"><span class="fa fa-pencil"></span></span>
                                                {{ form.apelido }}
                                            </div>
                                            <span class="help-block">Apelido do Cliente</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">{{ form.cpf.label_tag }}</label>
                                        <div class="col-md-9">
                                            <div class="input-group">
                                                <span class="input-group-addon"><span class="fa fa-credit-card"></span></span>
                                                {{ form.cpf }}
                                            </div>
                                            <label id="cpf-error" class="error"></label>
                                            <span class="help-block">Nome do Cliente</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">{{ form.nascimento.label_tag }}</label>
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon"><span class="fa fa-child"></span></span>
                                            {{ form.nascimento }}
                                            <span class="input-group-addon" id="result"></span>
                                        </div>
                                        <span class="help-block">Clique no campo acima pra escolher uma data</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Segunda coluna do formulario -->
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-md-3 control-label">{{ form.estado_civil.label_tag }}</label>
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon"><span class="fa fa-book"></span></span>
                                            {{ form.estado_civil }}
                                        </div>
                                        <span class="help-block">This is sample of text field</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">{{ form.sexo.label_tag }}</label>
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon"><span class="fa fa-intersex"></span></span>
                                            {{ form.sexo }}
                                        </div>
                                        <span class="help-block">This is sample of text field</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">{{ form.foto.label_tag }}</label>
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon"><span class="fa fa-camera"></span></span>
                                            {{ form.foto }}
                                        </div>
                                        <span class="help-block">Nome do Cliente</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">{{ form.status_ativo.label_tag }}</label>
                                    <div class="col-md-9">
                                        <label class="check">{{ form.status_ativo }}</label>
                                        <span class="help-block">Checkbox sample, easy to use</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                            </div>
                            <div class="tab-pane" id="tab-second">
                                <p>Donec tristique eu sem et aliquam. Proin sodales elementum urna et euismod. Quisque nisl nisl, venenatis eget dignissim et, adipiscing eu tellus. Sed nulla massa, luctus id orci sed, elementum consequat est. Proin dictum odio quis diam gravida facilisis. Sed pharetra dolor a tempor tristique. Sed semper sed urna ac dignissim. Aenean fermentum leo at posuere mattis. Etiam vitae quam in magna viverra dictum. Curabitur feugiat ligula in dui luctus, sed aliquet neque posuere.</p>
                                <div class="form-group">
                                    <div class="col-md-6">
                                        {{ formset }}
                                    </div>
                                </div>

                            </div>
                            <div class="tab-pane" id="tab-third">
                                <p>This is non libero bibendum, scelerisque arcu id, placerat nunc. Integer ullamcorper rutrum dui eget porta. Fusce enim dui, pulvinar a augue nec, dapibus hendrerit mauris. Praesent efficitur, elit non convallis faucibus, enim sapien suscipit mi, sit amet fringilla felis arcu id sem. Phasellus semper felis in odio convallis, et venenatis nisl posuere. Morbi non aliquet magna, a consectetur risus. Vivamus quis tellus eros. Nulla sagittis nisi sit amet orci consectetur laoreet.</p>

                            <div class="col-md-6">
                                <div class="form-group">
                                        <label class="col-md-3 control-label">{{ form.email.label_tag }}</label>
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <span class="input-group-addon"><span class="fa fa-at"></span></span>
                                                {{ form.email }}
                                            </div>
                                            <span class="help-block">Nome do Cliente</span>
                                        </div>
                                    </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">{{ form.telefone.label_tag }}</label>
                                    <div class="col-md-6">
                                        <div class="input-group">
                                            <span class="input-group-addon"><span class="fa fa-phone"></span></span>
                                            {{ form.telefone }}
                                        </div>
                                        <span class="help-block">Nome do Cliente</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                        <label class="col-md-3 control-label">{{ form.facebook.label_tag }}</label>
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <span class="input-group-addon"><span class="fa fa-facebook"></span></span>
                                                {{ form.facebook }}
                                            </div>
                                            <span class="help-block">Nome do Cliente</span>
                                        </div>
                                    </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">{{ form.instagram.label_tag }}</label>
                                    <div class="col-md-6">
                                        <div class="input-group">
                                            <span class="input-group-addon"><span class="fa fa-instagram"></span></span>
                                            {{ form.instagram }}
                                        </div>
                                        <span class="help-block">Nome do Cliente</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                        <div class="panel-footer">
                            <button type="submit" class="btn btn-primary pull-right">Salvar<span class="fa fa-floppy-o fa-right"></span></button>
                        </div>
                    </div>
                </form>

            </div>
        </div>

    </div>
    <!-- END PAGE CONTENT WRAPPER -->
{% endblock %}
{% block javascript %}
    <script type='text/javascript' src='{% static 'js/plugins/maskedinput/jquery.maskedinput.min.js' %}'></script>
    <script type='text/javascript' src='{% static 'js/plugins/jquery-validation/jquery.validate.js' %}'></script>
    <script>
        $(function() {
            $.mask.definitions['~'] = "[+-]";
            $("#id_nascimento").mask("99/99/9999");
            $(".phone").mask("(99) 99999-9999");
            $(".cpf").mask("999.999.999-99");

            $("input").blur(function() {
                $("#info").html("Unmasked value: " + $(this).mask());
            }).dblclick(function() {
                $(this).unmask();
            });
        });
    </script>
    <script type="text/javascript">
            var jvalidate = $("#jvalidate").validate({
                ignore: [],
                rules: {
                        login: {
                                required: true,
                                minlength: 2,
                                maxlength: 8
                        },
                        password: {
                                required: true,
                                minlength: 5,
                                maxlength: 10
                        },
                        're-password': {
                                required: true,
                                minlength: 5,
                                maxlength: 10,
                                equalTo: "#password2"
                        },
                        age: {
                                required: true,
                                min: 18,
                                max: 100
                        },
                        email: {
                                required: false,
                                email: true
                        },
                        date: {
                                required: true,
                                date: true
                        },
                        credit: {
                                required: true,
                                creditcard: true
                        },
                        site: {
                                required: true,
                                url: true
                        }
                    }
                });

        </script>
    <script>
        function FormatarData(dataFormatar){

            var dia = "";
            var mes = "";
            var ano = "";

            dia += dataFormatar[0];
            dia += dataFormatar[1];
            mes += dataFormatar[3];
            mes += dataFormatar[4];
            ano += dataFormatar[6];
            ano += dataFormatar[7];
            ano += dataFormatar[8];
            ano += dataFormatar[9];

            return mes+"/"+dia+"/"+ano;
        }

        function GetAge(nascimento){
            formatada = FormatarData(nascimento);
            dob = new Date(formatada);
            var today = new Date();
            var age = Math.floor((today-dob) / (365.25 * 24 * 60 * 60 * 1000));
            return age
        }

        $(document).ready(function(){
            $("#id_nascimento").focusout(function(){
                if ($("#id_nascimento").val() != "__/__/____") {
                    $("#result").text(GetAge($("#id_nascimento").val()));
                }
            });
        });
    </script>
    <script>
        function validaCPF(cpf) {
            var numeros, digitos, soma, i, resultado, digitos_iguais;
            cpf = cpf.replace(/\D/g,'');
            digitos_iguais = 1;
            if (cpf.length < 11)
                  return false;
            for (i = 0; i < cpf.length - 1; i++)
                  if (cpf.charAt(i) != cpf.charAt(i + 1))
                        {
                        digitos_iguais = 0;
                        break;
                        }
            if (!digitos_iguais)
                  {
                  numeros = cpf.substring(0,9);
                  digitos = cpf.substring(9);
                  soma = 0;
                  for (i = 10; i > 1; i--)
                        soma += numeros.charAt(10 - i) * i;
                  resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;
                  if (resultado != digitos.charAt(0))
                        return false;
                  numeros = cpf.substring(0,10);
                  soma = 0;
                  for (i = 11; i > 1; i--)
                        soma += numeros.charAt(11 - i) * i;
                  resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;
                  if (resultado != digitos.charAt(1))
                        return false;
                  return true;
                  }
            else
                return "Please enter a valid URL.";
          }

        $(document).ready(function(){
            $("#id_cpf").focusout(function(){
                // tentativa de validacao caso campo CPF nao seja vazio
                if ($("#id_cpf").val() != "___.___.___-__"){
                    // mostra erro caso CPF nao seja valido
                    if (validaCPF($("#id_cpf").val()) == false){
                        $("#cpf-error").text("CPF inválido");
                    }else {
                        $("#cpf-error").text("");
                    }
                }else {
                        $("#cpf-error").text("");
                    }
            });
        });
    </script>
{% endblock %}